n<-read.csv("~/Documents/Manuscripts/active/NanoporeMultiplexProtocol/accuracy.csv")
head(n)
boxplot(n$error~n$reads+n$method+n$polish)
n<-read.csv("~/Documents/Manuscripts/active/NanoporeMultiplexProtocol/accuracy.csv")
boxplot(n$error~n$reads+n$method+n$polish)
boxplot(n$error~n$reads+n$method+n$polish,las=2)
boxplot(n$error~n$reads+n$method+n$polish,las=2,horiz=T)
boxplot(n$error~n$reads+n$method+n$polish,las=2,horiz=T,cex.axis=0.5)
boxplot(n$error~n$method+n$reads+n$polish,las=2,horiz=T,cex.axis=0.5)
boxplot(n$error~n$method+n$reads+n$polish,las=2,horiz=T,cex.axis=0.5,log="y")
boxplot(n$error~n$method+n$reads+n$polish,las=2,horiz=T,cex.axis=0.5)
n_longread <- n[n$reads=="longreadonly"]
n_longread <- n[n$reads=="longreadonly",]
boxplot(n_longread $error~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5)
boxplot(n_longread $error~ n_longread $polish+ n_longread $method,las=2,horiz=T,cex.axis=0.5)
boxplot(n_longread $error~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5)
boxplot(n_longread $error~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5,col=c(2,4))
boxplot(n_longread $error~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5,col=c(2,4),ylim=c(0,0.2))
boxplot(n_longread $error~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5,col=c(2,4),ylim=c(0,0.02))
boxplot(n_longread $error*100~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5,col=c(2,4),ylim=c(0,0.02))
boxplot(n_longread $error*100~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5,col=c(2,4),ylim=c(0,2))
boxplot(n_longread $error*100~ n_longread $method+ n_longread $polish,las=2,horiz=T,cex.axis=0.5,col=c(2,4),ylim=c(0,2),ylab="% error")
n_hybrid_canu <- n[n$reads=="hybrid",]
boxplot(n_hybrid_canu$error*100 ~ n_hybrid_canu$polish)
boxplot(log(n_hybrid_canu$error*100) ~ n_hybrid_canu$polish)
boxplot(log(n_hybrid_canu$error*100+0.01) ~ n_hybrid_canu$polish)
boxplot(log(n_hybrid_canu$error*100) ~ n_hybrid_canu$polish)
boxplot(n_hybrid_canu$error*100 ~ n_hybrid_canu$polish)
plot(n_hybrid_canu$error*100,n_hybrid_canu$polish)
plot(n_hybrid_canu$polish, n_hybrid_canu$error*100)
plot(n_hybrid_canu$polish, n_hybrid_canu$error*100,log="y")
plot(n_hybrid_canu$polish, n_hybrid_canu$error*100)
head(n_hybrid_canu)
?prop.test
library(ggtree)
t<-read.tree("~/Dropbox/BINF90004/2017/prac/BEAST_files/BEAST_GC2subset_dates_snps_ucld.tree")
t<-read.beast("~/Dropbox/BINF90004/2017/prac/BEAST_files/BEAST_GC2subset_dates_snps_ucld.tree")
plot(t)
library(ggtree)
read.beast("~/Dropbox/BINF90004/2017/prac/BEAST_files/BEAST_GC2subset_dates_snps_ucld.tree")
t<-read.beast("~/Dropbox/BINF90004/2017/prac/BEAST_files/BEAST_GC2subset_dates_snps_ucld.tree")
plot(t)
? StatTreeHorizontal
?? StatTreeHorizontal
source("https://bioconductor.org/biocLite.R")
biocLite("ggtree")
library(ggtree)
plot(t)
t<-read.beast("~/Dropbox/BINF90004/2017/prac/BEAST_files/BEAST_GC2subset_dates_snps_ucld.tree")
plot(t)
unload(ggtree)
library(ggtree)
t<-read.beast("~/Dropbox/BINF90004/2017/prac/BEAST_files/BEAST_GC2subset_dates_snps_ucld.tree")
plot(t)
cols <- scale_color(x, by="height")
x<-t
cols <- scale_color(x, by="height")
ggtree(x, right=TRUE, mrsd="2014-04-02", color=cols) + theme_tree2() +#
geom_text(aes(x=max(x), label=label), size=1, color=cols, hjust=-.3) +#
scale_x_continuous(breaks=c(1992, 1995, 1997, 2000, 2002, 2005), minor_breaks=seq(1992, 2005, 1)) +#
geom_segment(aes(xend=max(x)+.20, yend=y), linetype="dotted", size=.1, color=cols) +#
theme(panel.grid.major   = element_line(color="black", size=.2),#
panel.grid.minor   = element_line(color="grey", size=.2),#
panel.grid.major.y = element_blank(),#
panel.grid.minor.y = element_blank())
ggtree(t)
x<-read.csv("~/Documents/TyphiProjects/Haplotyping/assigningSNPs/recombMasked_regionsMaskedFromSpecifiedStrains_var.csv")
colnames(x)[1:20]
subgroup <- c("X11642_2.69","X11642_2.7","X11642_2.87","X11642_2.86","X11642_2.56","X11800_1.32","X11800_1.7","X12045_3.81","X11800_1.55","X11800_1.88","X11642_2.33","X11642_2.58","X11800_1.79","X11800_1.77","X11800_1.15","X11642_2.54","X11642_2.53","X11642_2.82","X11642_2.63","X11642_2.65","X11642_2.66","X11642_2.70","X11642_2.68","X11800_1.34","X11642_2.17","X11642_2.26","X11642_2.27","X11800_1.57","X11642_2.2","X11800_1.58","X11642_2.84","X11642_2.77","X11642_2.13","X11642_2.16","X11642_2.1","X11642_2.67","X11800_1.62","X11800_1.85","X11642_2.39","X11800_1.53","X11642_2.21","X11642_2.71","X11800_1.48","X11800_1.72","X11800_1.56","X11800_1.80","X11642_2.32","X11800_1.63","X11800_1.54","X11800_1.82","X11642_2.81","X11642_2.51","X11642_2.49","X12045_3.70","X11800_1.9","X11800_1.18","X11800_1.65","X12045_3.76","X12045_3.75","X11642_2.15","X11642_2.79","X11642_2.60","X12045_3.72","X11642_2.10","X11642_2.72")
x<-read.csv("~/Documents/TyphiProjects/Haplotyping/assigningSNPs/recombMasked_regionsMaskedFromSpecifiedStrains_var.csv",row.names=1)
s <- x[,which (colnames(x) %in% subgroup)]
ncol(s)
colnames(x) %in% subgroup)
colnames(x) %in% subgroup
colnames(x)
colnames(x) %in% subgroup
library(shiny)
runApp('/Users/kat/code/Kleborate_viz/app.R')
runApp('/Users/kat/code/Kleborate_viz/app.R')
library(heatmaply)
x<-read.csv("/Users/kat/Dropbox/CurrOpp2018/refs/Plasmids/plasmid_mob_vs_species.csv")
heatmaply(x)
rep<-read.csv("/Users/kat/Dropbox/CurrOpp2018/refs/Plasmids/plasmid_repId_vs_species.csv")
heatmaply(rep)
library(shiny)
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
heatmaply(mtcars)
plot_ly(z = volcano, type = "heatmap")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
volcano
setwd("~/code/Kleborate_viz")
kleborate_data <- read.csv("kleborate_viz_test_data_mixedSTs.txt",sep="\t")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
vir_res <- table(factor(kleborate_data$resistance_score,c(0,1,2,3)),
factor(kleborate_data$virulence_score,c(0,1,2,3,4,5)))
vir_res <- data.frame(vir_res) # convert to matrix
vir_res <- vir_res[ order(-as.numeric(row.names(vir_res))),]
plot_ly(z=~vir_res, type="heatmap")
vir_res
vir_res <- table(factor(kleborate_data$resistance_score,c(0,1,2,3)),
factor(kleborate_data$virulence_score,c(0,1,2,3,4,5)))
vir_res
vir_res <- data.frame(vir_res)
vir_res
vir_res <- as.data.frame.matrix(vir_res)
vir_res <- table(factor(kleborate_data$resistance_score,c(0,1,2,3)),
factor(kleborate_data$virulence_score,c(0,1,2,3,4,5)))
vir_res <- as.data.frame.matrix(vir_res)
vir_res
vir_res <- vir_res[ order(-as.numeric(row.names(vir_res))),]
vir_res
plot_ly(z=~vir_res, type="heatmap")
heatmaply(vir_res)
plot_ly(z=~vir_res, type="heatmap")
plot_ly(z=~vir_res, type="heatmap",colors=colorRamp(c("red","green")))
volcano
is.matrix(volcano)
is.data.frame(volcano)
is.data.frame.matrix(volcano)
plot_ly(z=~as.matrix(vir_res), type="heatmap")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
plot_ly(z=~as.matrix(vir_res), type="heatmap")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
runApp("/Users/kat/code/Kleborate_viz/app.R")
plot_ly(z=~as.matrix(vir_res), type="heatmap",showlegend=F)
runApp("/Users/kat/code/Kleborate_viz/app.R")
heatmaply(as.data.frame.matrix(vir_res))
vir_res
data_matrix <- kleborate_data[[kleborate_data$ST =="ST25",]
)
data_matrix <- kleborate_data[kleborate_data$ST =="ST25",]
data_matrix
rownames(data_matrix) <- data_matrix[,1]
head(data_matrix)
vir_data_matrix <- (data_matrix[,c(virulence_locus_columns)]!="-")*1
resistance_class_columns <- as.character(column_decoder$column_name[column_decoder$type =="resistance_class"])
virulence_locus_columns <- as.character(column_decoder$column_name[column_decoder$type =="virulence_locus"])
column_decoder <- read.csv("column_decoder.txt",sep="\t")
resistance_class_columns <- as.character(column_decoder$column_name[column_decoder$type =="resistance_class"])
virulence_locus_columns <- as.character(column_decoder$column_name[column_decoder$type =="virulence_locus"])
vir_data_matrix <- (data_matrix[,c(virulence_locus_columns)]!="-")*1
res_data_matrix <- (data_matrix[,c(resistance_class_columns)]!="-")*2 # convert to binary matrix
st_data_matrix <- as.data.frame.matrix(cbind(vir_data_matrix,res_data_matrix)) # format for heatmaply
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25"
)
apply(st_data_matrix,1,mean)
apply(st_data_matrix,2,mean)
genefreq <- apply(st_data_matrix,2,mean)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette=colorRamp(c("white","black"))
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette=colorRamp(c("#ffffff","#000000"))
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette=colorRamp(c("white","black"))(10)
)
colorRamp(c("white","black"))(10)
colorRampPalette(c("blue", "red"))( 4 )
colorRampPalette(c("white","black"))(10)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette=colorRampPalette(c("white","black"))(10)
)
colorRampPalette(c("white","black"))(10)
viridis_pal(option = "D")
show_col(viridis_pal()(10))
library(scales)
show_col(viridis_pal()(10))
show_col(viridis_pal()(10))
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette = viridis_pal(option = "D")
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette = magma(n, alpha = 1, begin = 0, end = 1)
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette = viridis_pal(option = "magma")
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette = viridis_pal(option = "inferno")
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette = viridis_pal(option = "plasma")
)
viridis_pal(option = "plasma")
?heatmaply
?colorRamp
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette = colorRamp(c("white","black"))
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25", col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"))
)
head(vir_data_matrix)
apply(vir_data_matrix,1,mean)
virload <- apply(vir_data_matrix,1,mean)
resload <- apply(res_data_matrix,1,mean)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=c(virload,resload), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=c(virload,resload), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25"
)
)
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=c(virload,resload), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25"
)
)
virload
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=data.frame(cbind(virload,resload)), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25"
)
)
data.frame(cbind(virload,resload))
as.data.frame.matrix(cbind(virload,resload))
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25"
))
heatmaply(st_data_matrix, Rowv=T, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)), row_side_palette = colorRampPalette(c("white","#2171b5")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = "ST25"
))
main_title="ST25"
rowv=T
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=c(virload,resload), row_side_palette = colorRampPalette(c("white","#2171b5")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
row_side_colors=c(virload,resload),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black"),
# 		row_side_colors=c(virload,resload), row_side_palette = colorRampPalette(c("white","#2171b5")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
# 		row_side_colors=c(virload,resload), row_side_palette = colorRampPalette(c("white","#2171b5")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=c(virload,resload), row_side_palette = colorRampPalette(c("white","#2171b5")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=c(virload,resload), row_side_palette = colorRampPalette(c("white","#2171b5"),c("white","#ef3b2c")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=cbind(virload,resload), row_side_palette = colorRampPalette(c("white","#2171b5"),c("white","#ef3b2c")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)), row_side_palette = colorRampPalette(c("white","#2171b5"),c("white","#ef3b2c")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)), row_side_palette = colorRampPalette(c("white","#2171b5")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=c(virload,resload), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c")))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=c(virload,resload), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)), row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = c(colorRampPalette(c("white","#2171b5")),colorRampPalette(c("white","#ef3b2c"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = c(colorRampPalette(c("white","#2171b5"))),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = colorRampPalette(c("white","#2171b5")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = colorRampPalette(c("white","#black")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=genefreq, col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = colorRampPalette(c("white","black")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = colorRampPalette(c("white","black")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = colorRampPalette(c("white","#2171b5","white","#ef3b2c")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload+1)),
row_side_palette = colorRampPalette(c("white","#2171b5","white","#ef3b2c")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(vir_load=virload,res_load=resload+1)),
row_side_palette = colorRampPalette(c("white","#2171b5","white","#ef3b2c")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(vir_load=virload,res_load=resload+1)),
row_side_palette = colorRampPalette(c("white","#2171b5","white","#ef3b2c")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
resload <- apply(res_data_matrix,1,mean)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = colorRampPalette(c("white","black")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
#          col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_palette = colorRampPalette(c("white","black")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
})
head(data_matrix)
heatmaply(st_data_matrix, Rowv=rowv, Colv=NULL, xlab = "genotypes", hide_colorbar=T,
fontsize_row = 6, fontsize_col = 7,  revC=F,
#          col_side_colors=as.data.frame.matrix(cbind(gene_freq=genefreq)), col_side_palette = colorRampPalette(c("white","black")),
#          row_side_colors=as.data.frame.matrix(cbind(virload,resload)),
row_side_colors=as.data.frame.matrix(data_matrix[,c("virulence_score","resistance_score","num_resistance_classes","num_resistance_genes")]),
row_side_palette = colorRampPalette(c("white","black")),
# 		showticklabels = c(TRUE,print_row_names),
colors=c("white","#2171b5","#ef3b2c"), main = main_title
)
runApp("/Users/kat/code/Kleborate_viz/app.R")
library(shinyHeatmaply)
install.packages('shinyHeatmaply')
install.packages("shinyHeatmaply")
